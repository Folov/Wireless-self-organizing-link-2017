# 应用场景
在A点与B点之间，沿直线放置N台无线路由器。各路由器间距在30m左右。
假设：S ----- R4 ----- R3 ----- R2 ----- R1 ----- U
源端S在头，用户端U在尾。用户端U执行建链脚本WSOL_User.sh。1分钟左右建链完成。S端和U端可互相通信。

# 正常使用
## 使用步骤

1. 按照：S ---- R1 ---- R2 ---- U 的顺序放置路由器，先开机S和R类设备；
2. 开机等待1分钟初始化完毕；
3. 开机用户端路由器U，电脑网线连接路由器WAN口，设置电脑IP段为192.168.12.X，通过Xshell进入后台（192.168.12.17），运行程序/root/WSOL_User.sh；
4. 3台路由器等待1~2分钟即可建链完毕。
5. 设备可通过有线或无线方式接入链路两端（S、U），采用不同的IP地址进行通信。接入设备的ip需选择与接入路由器相同 ip段内的ip，采用静态ip方式进行接入。

## IP地址分配

1. 源端S：LAN（192.168.11.11），WAN（192.168.12.11），WiFi与LAN桥接。接入设备使用静态ip，网段采用192.168.11.0，例如（192.168.11.205），网关使用192.168.11.11；
2. 用户端U：LAN（192.168.17.17），WAN（192.168.12.17），WiFi与LAN桥接。接入设备使用静态IP，网段采用192.168.17.0，例如（192.168.17.205），网关使用192.168.17.17。
3. 配置完毕后192.168.11.205可与192.168.17.205通信。


# 程序部署（恢复出厂设置后的部署流程）
## 说明

1. 路由器事先刷固件。根据路由器的不同选择不同的固件进行刷入。出厂后固件均已刷。
2. 共有3个文件夹 *Source* *Relay* *User* 每个文件夹对应一种节点。链路中只有这三种节点。
3. 每个程序包（openwrtXX）均对应某一款路由器型号，具体见程序包内README.md文件。
4. 文件夹下的openwrtXX标明该程序部署到路由器后的wifi名称是"openwrtXX"，其WAN口IP地址为192.168.12.XX，可由此IP地址登录后台控制端。
5. 路由器初始LAN口IP地址为192.168.1.1.无密码。程序部署后，LAN口IP地址变为192.168.XX.XX，WAN口IP地址变为192.168.12.XX。无密码。密码可登录web界面自己设置。
6. 首先部署Source端和Relay端路由器。最后部署User端路由器。

## 详细步骤

1. 拿到新的（恢复出厂设置的）路由器，电脑网线连接路由器LAN口，使用winscp登录192.168.1.1进入路由器文件系统（注意修改电脑ip为192.168.1.0网段）。
2. 将与路由器型号对应的程序包（openwrtXX）内的所有文件，拷贝到路由器的"/root/"目录下。
3. 使用Putty或着Xshell登录路由器命令行界面，进入"/root/"目录，执行命令: chmod +x ./*
4. *对于S端和R端*，接着进入/etc/文件夹，修改rc.local文件，在“exit 0”上面加入如下文字: /root/WSOL_XXX.sh &（注：当使用的是Source节点程序包时，XXX是Source，是Relay程序包时，XXX是Relay）
5. *对于U端*，执行：/root/ap17.sh （这里假设是openwrt17）
6. 重启
7. 部署完毕，即可按照正常使用步骤操作。
